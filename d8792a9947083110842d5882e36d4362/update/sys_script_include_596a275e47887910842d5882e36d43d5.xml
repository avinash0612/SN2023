<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_script_include">
    <sys_script_include action="INSERT_OR_UPDATE">
        <access>public</access>
        <active>true</active>
        <api_name>x_27034_stocks.stocksv2</api_name>
        <caller_access/>
        <client_callable>false</client_callable>
        <description/>
        <name>stocksv2</name>
        <script><![CDATA[var stocksv2 = Class.create();
stocksv2.prototype = {
    initialize: function() {},
    runScript: function() {
        // API endpoint 
        var apiUrl = 'https://financialmodelingprep.com/api/v3/quote/';
        var apiKey = '38a756289daffb0e571c309c71abfccd';
        // Create REST message  
        var restMessage = new sn_ws.RESTMessageV2();
        // Set headers
        restMessage.setRequestHeader('Content-Type', 'application/json');
        var grstocks = new GlideRecord('x_27034_stocks_stocks')
        grstocks.query();
        // Loop through result set
        while (grstocks.next()) {
            // Get stock name
            var symbol = grstocks.symbol;
            // Call API  
            // Set endpoint and parameters
            restMessage.setEndpoint(apiUrl + symbol + "?apikey=" + apiKey);
            restMessage.setHttpMethod('GET');
            // Execute request
            var response = restMessage.execute();
            var responseBody = response.getBody();
            // gs.print(responseBody);
            // Parse and print price
            var stockData = JSON.parse(responseBody);
            var price = stockData[0].price;
            gs.info(symbol + ' price: ' + price);
            // Update price field
            grstocks.price = price;
            // Update record
            grstocks.update();
        }
    },

    type: 'stocksv2'
};]]></script>
        <sys_class_name>sys_script_include</sys_class_name>
        <sys_created_by>avi</sys_created_by>
        <sys_created_on>2023-07-18 01:15:08</sys_created_on>
        <sys_id>596a275e47887910842d5882e36d43d5</sys_id>
        <sys_mod_count>4</sys_mod_count>
        <sys_name>stocksv2</sys_name>
        <sys_package display_value="stocks" source="x_27034_stocks">d8792a9947083110842d5882e36d4362</sys_package>
        <sys_policy>read</sys_policy>
        <sys_scope display_value="stocks">d8792a9947083110842d5882e36d4362</sys_scope>
        <sys_update_name>sys_script_include_596a275e47887910842d5882e36d43d5</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2023-07-18 13:03:25</sys_updated_on>
    </sys_script_include>
</record_update>
